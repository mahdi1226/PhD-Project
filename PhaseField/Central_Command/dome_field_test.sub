#!/bin/bash
#==============================================================================
# Dome Field Distribution Tests
#
# INSTRUCTIONS: Change TEST_NAME in 3 places (lines marked with ***)
#
# TEST NAMING CONVENTION:
#   soft_001  = Softening, delta_sq = 0.01
#   soft_004  = Softening, delta_sq = 0.04
#   soft_016  = Softening, delta_sq = 0.16
#   power_15  = Power law, power = 1.5
#   power_10  = Power law, power = 1.0
#   power_05  = Power law, power = 0.5
#   gauss_03  = Gaussian edge boost, sigma = 0.3
#   gauss_05  = Gaussian edge boost, sigma = 0.5
#   gauss_08  = Gaussian edge boost, sigma = 0.8
#   wide_dip  = Widened dipoles [0.1, 0.9], no smoothing
#==============================================================================

#SBATCH --job-name=dome_soft_004
#SBATCH --output=dome_soft_004_%j.out
#SBATCH --error=dome_soft_004_%j.err
#SBATCH --partition=general
#SBATCH --time=24:00:00
#SBATCH --mem=64G
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --mail-type=BEGIN,END,FAIL

# *** CHANGE THIS TO MATCH JOB NAME ABOVE ***
TEST_NAME="soft_004"

module load dealii/9.7.1_umfpack
source /share/apps/common/SPACK_v110_release_a2/spack/opt/spack/linux-x86_64/dealii-9.7.1-kr766e7zm3gq6q7t67vefndkrhcyvmrw/.spack/spack-build-env.txt

# Create output directory with test name
OUTPUT_DIR="/share/ceph/scratch/mg6f4/dealii_runs/dome_${TEST_NAME}"
mkdir -p ${OUTPUT_DIR}
cd ${OUTPUT_DIR}

echo "============================================="
echo "Test: ${TEST_NAME}"
echo "Output: ${OUTPUT_DIR}"
echo "Started: $(date)"
echo "============================================="

/home/mg6f4/PhD-Project/PhaseField/build-release/ferrofluid \
  --dome \
  --refinement 6 \
  --no_amr \
  --no_adaptive_dt \
  --direct \
  --verbose

echo "============================================="
echo "Finished: $(date)"
echo "============================================="
